(()=>{"use strict";if(void 0===lpGlobalSettings)throw new Error("lpGlobalSettings is undefined");const e={apiCourses:lpGlobalSettings.lp_rest_url+"lp/v1/courses/archive-course"};(()=>{if(void 0===lpGlobalSettings)return void console.log("lpGlobalSettings is undefined");const t=document.location.href;let o,r,s,l,n,a,c=JSON.parse(window.localStorage.getItem("lp_filter_courses"))||{},i=!1,u=1;if(!lpGlobalSettings.lpArchiveLoadAjax)return void console.log("Option load courses ajax is disabled");lpGlobalSettings.is_course_archive&&(window.location.search.length||-1!==t.search("page")||(c={}));const p=(e,t)=>{const o=new URL(e);return Object.keys(t).forEach((e=>{o.searchParams.set(e,t[e])})),o};window.lpArchiveRequestCourse=(t,c)=>{if(i)return;i=!0,r&&l.append(r);const h=p(e.apiCourses,{...lpGlobalSettings.lpArchiveSkeleton,...t}),g=e.apiCourses+h.search;let v={method:"GET"};0!==lpGlobalSettings.user_id&&(v={...v,headers:{"X-WP-Nonce":lpGlobalSettings.nonce}}),fetch(g,v).then((e=>e.json())).then((e=>{if(n=e.data.content||"",a=e.data.pagination||"",r||(r=o.cloneNode(!0)),!u){l.innerHTML=n;const e=a,t=document.querySelector(".learn-press-pagination");if(t&&t.remove(),void 0!==e){const t=(new DOMParser).parseFromString(e,"text/html").querySelector(".learn-press-pagination");t&&(l.after(t),d())}}wp.hooks.doAction("lp-js-get-courses",e),"function"==typeof c&&c(e)})).catch((e=>{l.innerHTML+=`<div class="lp-ajax-message error" style="display:block">${e.message||"Error: Query lp/v1/courses/archive-course"}</div>`})).finally((()=>{if(i=!1,document.querySelector("form.search-courses button").classList.remove("loading"),u)u=0;else{const e={behavior:"smooth"};s.scrollIntoView(e)}window.localStorage.setItem("lp_filter_courses",JSON.stringify(t));const e=p(document.location,t);window.history.pushState("","",e)}))},lpGlobalSettings.lpArchiveNoLoadAjaxFirst?u=0:lpArchiveRequestCourse(c);const d=()=>{const e=document.querySelectorAll(".lp-archive-courses .learn-press-pagination .page-numbers");e.length>0&&e.forEach((t=>t.addEventListener("click",(r=>{if(r.preventDefault(),r.stopPropagation(),!s)return;o&&(o.style.display="block"),s.scrollIntoView({behavior:"smooth"});let l={};if(l=JSON.parse(window.localStorage.getItem("lp_filter_courses"))||{},r.currentTarget.getAttribute("href")){const o=[...e].filter((e=>e.classList.contains("current"))),s=r.currentTarget.textContent||t.classList.contains("next")&&parseInt(o[0].textContent)+1||t.classList.contains("prev")&&parseInt(o[0].textContent)-1;l.paged=s,lpArchiveRequestCourse({...l})}}))))},h=()=>{(()=>{if(!lpGlobalSettings.lpArchiveNoLoadAjaxFirst){l.innerHTML=n;const e=a,t=document.querySelector(".learn-press-pagination");if(t&&t.remove(),void 0!==e){const t=(new DOMParser).parseFromString(e,"text/html").querySelector(".learn-press-pagination");t&&l.after(t)}}d(),(()=>{const e=document.querySelectorAll("form.search-courses"),t=JSON.parse(window.localStorage.getItem("lp_filter_courses"))||{};e.forEach((e=>{const r=e.querySelector('input[name="c_search"]'),s=e.querySelector('[type="submit"]');let l;r.addEventListener("keyup",(e=>{o&&(o.style.display="block"),e.preventDefault();const r=e.target.value.trim();(!r||r&&r.length>2)&&(void 0!==l&&clearTimeout(l),l=setTimeout((function(){s.classList.add("loading"),t.c_search=r,t.paged=1,lpArchiveRequestCourse({...t})}),800))})),e.addEventListener("submit",(t=>{t.preventDefault();const o=e.querySelector('input[name="c_search"]');o&&o.dispatchEvent(new Event("keyup"))}))}))})()})(),(()=>{const e=document.querySelectorAll('.lp-archive-courses input[name="lp-switch-layout-btn"]');e.length>0&&e.forEach((e=>e.addEventListener("change",(e=>{e.preventDefault();const t=e.target.value;if(t){const e=document.querySelector(".lp-archive-courses .learn-press-courses[data-layout]");e&&(e.dataset.layout=t),LP.Cookies.set("courses-layout",t)}}))))})(),(()=>{const e=LP.Cookies.get("courses-layout"),t=document.querySelectorAll('.lp-courses-bar .switch-layout [name="lp-switch-layout-btn"]');t.length>0&&[...t].map((t=>t.value===e&&(t.checked=!0)))})()},g=setInterval((function(){o=document.querySelector(".lp-archive-course-skeleton"),s=document.querySelector(".lp-archive-courses"),s&&(l=s.querySelector("ul.learn-press-courses"));let e=!1;l&&o&&((lpGlobalSettings.lpArchiveNoLoadAjaxFirst||n)&&(e=!0),e&&(h(),clearInterval(g)))}),1)})()})();